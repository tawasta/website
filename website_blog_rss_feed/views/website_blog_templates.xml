<?xml version="1.0" encoding="UTF-8" ?>
<odoo>
    <!-- Atom Feed -->
    <template id="blog_feed_rss_feed" inherit_id="website_blog.blog_feed">
        <xpath expr="//summary" position="after">
            <t
                t-set="_cp"
                t-value="json.loads(post.cover_properties).get('background-image', 'none')[4:-1].strip('\'')"
            />
            <t t-if="_cp">
                <t t-set="banner_image_url" t-value="base_url + _cp" />
                <t
                    t-set="banner_length"
                    t-value="get_attachment_from_url(_cp).file_size"
                />
                <t
                    t-set="banner_type"
                    t-value="get_attachment_from_url(_cp).mimetype"
                />
                <enclosure
                    t-attf-url="#{banner_image_url}"
                    t-attf-length="#{banner_length}"
                    t-attf-type="#{banner_type}"
                />
            </t>
            <content t-esc="post.content" />
            <published t-esc="str(post.post_date).replace(' ', 'T') + 'Z'" />
        </xpath>
    </template>
    <template id="blog_custom_feed">&lt;?xml version="1.0" encoding="utf-8"?&gt;
        <feed t-att-xmlns="'http://www.w3.org/2005/Atom'"><title
                t-esc="feed.name"
            /><description t-esc="feed.description" /><link
                t-att-href="'%s/blog' % (base_url)"
            /><id t-esc="'%s/blog' % (base_url)" /><updated
                t-esc="str(posts[0].post_date).replace(' ', 'T') + 'Z' if posts else ''"
            /><entry t-foreach="posts" t-as="post"><title t-esc="post.name" /><link
                    t-att-href="'%s%s' % (base_url, post.website_url)"
                /><id t-esc="'%s%s' % (base_url, post.website_url)" /><author><name
                        t-esc="post.sudo().author_id.name"
                    /></author><summary t-esc="html2plaintext(post.teaser)" /><t
                    t-set="_cp"
                    t-value="json.loads(post.cover_properties).get('background-image', 'none')[4:-1].strip('\'')"
                /><t t-if="_cp"><t
                        t-set="banner_image_url"
                        t-value="base_url + _cp"
                    /><t
                        t-set="banner_length"
                        t-value="get_attachment_from_url(_cp).file_size"
                    /><t
                        t-set="banner_type"
                        t-value="get_attachment_from_url(_cp).mimetype"
                    /><enclosure
                        t-attf-url="#{banner_image_url}"
                        t-attf-length="#{banner_length}"
                        t-attf-type="#{banner_type}"
                    /></t><content t-esc="post.content" /><published
                    t-esc="str(post.post_date).replace(' ', 'T') + 'Z'"
                /><updated
                    t-esc="str(post.post_date).replace(' ', 'T') + 'Z'"
                /></entry></feed>
    </template>
</odoo>
